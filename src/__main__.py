import urllib
from urllib import request
import json
import os
import sys
import hashlib
from modules import lookup

if __name__ == "__main__":
    for i in sys.argv:
        if i.startswith("--scan-file="):
            file_path = i.replace("--scan-file=", "")
            if os.path.exists(file_path):
                file_hash = hashlib.sha256(open(file_path, "rb").read())
                result = lookup.check_file(file_hash.hexdigest())
                if result == "hash_not_found":
                    print("File not found in database")
                else:
                    print("[ FOUND ] A malware sample with the same hash was found on malware bazzar")
                    print("Name:"+result["name"]+"\n"+"Type:"+result["type"]+"\n"+"Size:"+str(result["size"]))
            else:
                print("File not found")
        elif i.startswith("--scan-hash="):
            file_hash = i.replace("--scan-hash=", "")
            result = lookup.check_file(file_hash)
            if result == "hash_not_found":
                print("File not found in database")
            else:
                print("[ FOUND ] A malware sample with the same hash was found on malware bazzar")
                print("Name:"+result["name"]+"\n"+"Type:"+result["type"]+"\n"+"Size:"+str(result["size"]))


            